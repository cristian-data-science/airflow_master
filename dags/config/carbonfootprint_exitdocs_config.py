from datetime import timedelta, datetime

# Default variables
default_args = {
    'owner': 'airflow',
    'depends_on_past': False,
    'start_date': datetime(2024, 11, 26, 9, 0),
    'email': [
        'enrique.urrutia@patagonia.com',
    ],
    'email_on_failure': True,
    'email_on_retry': False,
    'retries': 1,
    'retry_delay': timedelta(minutes=5),
    'snowflake_conn_id': 'patagonia_snowflake_connection',
}

# Columns for CARBONFOOTPRINT_EXITDOCS table
carbonfootprint_exitdocs_columns = [
    ('ORIGIN_NAME', 'STRING'),
    ('ORIGIN_ZIP_CODE', 'STRING'),
    ('CHANNEL', 'STRING'),
    ('DESTINATION_ZIP_CODE', 'STRING'),
    ('DESTINATION_ADDRESS', 'STRING'),
    ('MODE', 'STRING'),
    ('DISTANCE_KM', 'NUMBER(10,2)'),
    ('WEIGHT_KG', 'NUMBER(10,2)'),
    ('EMISSIONS_FACTOR', 'NUMBER(18,6)'),
    ('IS_ELECTRIC', 'STRING'),
    ('FECHA', 'DATE'),
    ('REFERENCE_NUMBER', 'STRING'),
]

# Tabla de distancias desde Pudahuel a diferentes destinos
# Formato: {destino_ciudad: (zip_code_destino, distancia_km)}
DISTANCE_TABLE = {
    # Destinos desde Pudahuel
    'Coyhaique': ('5950000', 1351.146535),
    'Puerto Montt': ('5480000', 911.6068176),
    'Puerto Varas': ('5550000', 895.8257046),
    'Pucón': ('4920000', 656.1541037),
    'Concepción': ('4030000', 430.2079822),
    'Temuco': ('4780000', 610.2732671),
    'Osorno': ('5290000', 819.545836),
    'Las Condes': ('7550000', 15.66386981),
    'Providencia': ('7500000', 12.14503446),
    'Lo Barnechea': ('7690000', 23.60270872),
    'Quilicura': ('8700000', 9.820005507),
    'Renca': ('8640000', 4.653443496),
    'Estación Central': ('9160000', 11.7509828),
    'Vitacura': ('7630000', 17.75459058),
    'Puente Alto': ('8150000', 23.88143002),
    'Santiago': ('8320000', 8.284140312),
    'Ñuñoa': ('7750000', 13.06396984),
    'Quinta Normal': ('8500000', 11.7509828),
    'Pudahuel': ('9020000', 10),
    'Lo Espejo': ('9120000', 9.632418044),
    'Recoleta': ('8420000', 10.91300052),
    'Lampa': ('9380000', 11.7509828),
    'San Miguel': ('8900000', 10.11122947),
    'Peñalolén': ('7910000', 21.99096963),
    'Quillota': ('2260000', 78.24706011),
    'Copiapó': ('1530000', 675.6863107),
    'Viña del Mar': ('2520000', 88.80490754),
    'Lota': ('4210000', 544),
    'Calera de Tango': ('9560000', 20.7520015),
    'Talca': ('3460000', 235.5383226),
    'Maipú': ('9250000', 5.982956907),
    'Linares': ('3580000', 282.3406255),
    'Castro': ('5700000', 1037.561267),
    'Iquique': ('1100000', 1467.359988),
    'Cauquenes': ('3690000', 316.2542657),
    'San Pedro de la Paz': ('4130000', 434.0245739),
    'Calama': ('1390000', 1230.830799),
    'Hijuelas': ('2310000', 80.83456387),
    'Ovalle': ('1840000', 318.0894301),
    'Quilpué': ('2430000', 79.24062012),
    'Macul': ('7810000', 13.79322396),
    'Colina': ('9340000', 27.53129962),
    'Valparaíso': ('2340000', 93.09356075),
    'Santa Cruz': ('3130000', 144.674099),
    'Pichilemu': ('3220000', 156.4071185),
    'Buin': ('9500000', 31.88543231),
    'San Carlos': ('3840000', 348.8343206),
    'Arauco': ('4360000', 482.4245161),
    'San Antonio': ('2660000', 82.60034534),
    'Constitución': ('3560000', 259.7092168),
    'Punta Arenas': ('6200000', 2190.705947),
    'Los Ángeles': ('4440000', 470.0156176),
    'Salamanca': ('1950000', 185.7350203),
    'Concón': ('2510000', 92.66399303),
    'Puerto Natales': ('6160000', 2036.129983),
    'Chillán': ('3780000', 372.1909996),
    'Antofagasta': ('1240000', 1086.439318),
    'Machalí': ('2910000', 82.27084593),
    'Molina': ('3380000', 177.300178),
    'Pichidegua': ('2980000', 113.1243287),
    'Río Bueno': ('5240000', 789.5611409),
    'Melipilla': ('9580000', 50.65293669),
    'Puerto Cisnes': ('6010000', 1261.689929),
    'La Serena': ('1700000', 395.7079343),
    'La Florida': ('8240000', 20.62119325),
    'Rancagua': ('2820000', 80.49929443),
    'Curicó': ('3340000', 177.1758568),
    'Coquimbo': ('1780000', 386.9591257),
    'Los Andes': ('2100000', 69.59082969),
    'Futrono': ('5180000', 757.0475242),
    'Padre Hurtado': ('9710000', 17.36870113),
    'Ancud': ('5710000', 973.3937144),
    'Cañete': ('4390000', 537.5827631),
    'Panguipulli': ('5210000', 703.079141),
    'Santo Domingo': ('2720000', 74.94975083),
    'Renaico': ('4670000', 496.8794766),
    'Mariquina': ('5150000', 702.0778618),
    'Litueche': ('3240000', 118.9152126),
    'Villarrica': ('4930000', 661.5217259),
    'La Unión': ('5250000', 788.2049642),
    'Requínoa': ('2930000', 96.09313309),
    'Aysén': ('6000000', 1339.63385),
    'San Clemente': ('3520000', 242.1579965),
    'Longaví': ('3620000', 292.3551269),
    'Curacaví': ('9630000', 25.60776189),
    'Casablanca': ('2480000', 52.04472891),
    'La Cruz': ('2280000', 71.46215278),
    'Peumo': ('2990000', 111.9563057),
    'La Reina': ('7850000', 30.7654124),
    'Collipulli': ('4680000', 523.107007),
    'Cartagena': ('2680000', 70.68354922),
    'Villa Alemana': ('6500000', 63.54680836),
    'Nueva Imperial': ('5020000', 621.2812904),
    'Carahue': ('5010000', 625.8394586),
    'Chiguayante': ('4100000', 436.2666316),
    'San Javier': ('3660000', 254.0045625),
    'Freire': ('4940000', 633.9440292),
    'Arica': ('1000000', 1658.306014),
    'Quemchi': ('5720000', 994.2576135),
    'Curacautín': ('4700000', 563.5726129),
    'Maule': ('3530000', 246.3983198),
    'Lolol': ('3140000', 167.9315053),
    'La Calera': ('2290000', 84.57101965),
    'Algarrobo': ('2710000', 87.13637556),
    'Curaco de Vélez': ('5740000', 1029.366597),
    'Puerto Octay': ('5370000', 857.0377609),
    'Illapel': ('1930000', 204.8995531),
    'Chile Chico': ('6050000', 1456.47735),
    'Cabrero': ('4470000', 425.4654842),
    'Lago Ranco': ('5220000', 778.6493805),
    'Curanilahue': ('4370000', 505.8754011),
    'Loncoche': ('4970000', 679.0408307),
    'Nogales': ('2300000', 91.38843864),
    'Los Lagos': ('5170000', 735.7471589),
    'Peralillo': ('3170000', 133.4314929),
    'Rengo': ('2940000', 107.5534757),
    'Lebu': ('4350000', 532.3776106),
    'Hualañé': ('3400000', 178.5428863),
    'Chillán Viejo': ('3820000', 376.8125553),
    'Padre Las Casas': ('4850000', 614.097029),
    'Parral': ('3630000', 315.1316401),
    'Frutillar': ('5620000', 876.161719),
    'Chonchi': ('5770000', 1052.885724),
    'Talagante': ('9670000', 29.45954215),
    'Vallenar': ('1610000', 539.8801064),
    'Peñaflor': ('9750000', 22.01127611),
    'Vicuña': ('1760000', 378.1694564),
    'Lautaro': ('4860000', 584.5173848),
    'Yungay': ('3920000', 422.4159017),
    'El Monte': ('9810000', 34.05179515),
    'Cochrane': ('6100000', 1541.057859),
    'Quirihue': ('4000000', 356.0391265),
    'Monte Patria': ('1880000', 305.6344624),
    'Puchuncaví': ('2500000', 101.560506),
    'Vilcún': ('4880000', 593.5182523),
    'Talcahuano': ('4260000', 419.2325807),
    'San Fernando': ('3070000', 129.6815685),
    'Cerrillos': ('9200000', 15.82971649),
    'Angol': ('4650000', 513.8297377),
    'La Cisterna': ('7970000', 22.17491319),
    'La Ligua': ('2030000', 112.9280875),
    'Quinta de Tilcoco': ('2960000', 99.11651188),
    'Nacimiento': ('4550000', 481.7852928),
    'San Pedro de Atacama': ('1410000', 1193.411765),
    'Tocopilla': ('1340000', 1256.975066),
    'Valdivia': ('5090000', 741.4368197),
    'San Vicente de Tagua Tagua': ('2970000', 114.8361082),
    'El Bosque': ('8010000', 42.00247377),
    'Huechuraba': ('8580000', 21.35393902),
    'San Clemente': ('3520000', 242.1579965),
    'Los Vilos': ('1940000', 177.9370199),
    'Traiguén': ('4730000', 560.2603309),
    'San José de Maipo': ('9460000', 9.820005507),
    'Pinto': ('3880000', 376.5110489),
    'Quillón': ('3940000', 399.4303807),
    'Futaleufú': ('5870000', 1113.570337),
    'Llanquihue': ('2220000', 890.2410659),
    'San Joaquín': ('8940000', 15.94657933),
    'Tortel': ('6110000', 1611.064123),
    'Puyehue': ('5360000', 819.5732624),
    'Corral': ('5190000', 753.2958875),
    'San Esteban': ('2120000', 74.38862914),
    'Catemu': ('2220000', 76.75121041),
    'Calle Larga': ('2100000', 69.10919145),
    'Papudo': ('2070000', 122.5346627),
    'Panquehue': ('2210000', 77.57738949),
    'Santa María': ('2200000', 70.93293154),
    'San Felipe': ('2170000', 77.89169379),
    'Antuco': ('4490000', 434.6015532),
    'Alto Biobío': ('4490000', 529.3132952),
    'María Elena': ('1360000', 1234.810976),
    'Máfil': ('5180000', 716.0243083),
    'Ñiquén': ('3860000', 335.1723647),
    'San Nicolás': ('3890000', 362.8716154),
    'Queilén': ('5780000', 1074.510372),
    'Coelemu': ('3970000', 382.168036),
    'Portezuelo': ('3980000', 377.0191127),
}

# Mapeo de RECEIVING_WAREHOUSE_ID a ciudad de destino
WAREHOUSE_TO_CITY = {
    'LADEHESA': 'Lo Barnechea',
    'LASCONDES': 'Las Condes',
    'MALLSPORT': 'Las Condes',
    'COSTANERA': 'Providencia',
    'BNAVENTURA': 'Quilicura',
    'CONCEPCION': 'Concepción',
    'TEMUCO': 'Temuco',
    'OSORNO': 'Osorno',
    'ALERCE': 'Puerto Montt',
    'PTOVARAS': 'Puerto Varas',
    'COYHAIQUE': 'Coyhaique',
    'PUCON': 'Pucón',
    'CD': 'Pudahuel',
}
